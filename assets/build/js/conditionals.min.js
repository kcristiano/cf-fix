var calders_forms_check_conditions,calders_forms_init_conditions;!function(a){var b={},c={};Array.prototype.indexOf||(Array.prototype.indexOf=function(a){var b=this.length>>>0,c=Number(arguments[1])||0;for(c=c<0?Math.ceil(c):Math.floor(c),c<0&&(c+=b);c<b;c++)if(c in this&&this[c]===a)return c;return-1}),cf_debounce=function(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,c||a.apply(e,f)},h=c&&!d;clearTimeout(d),d=setTimeout(g,b),h&&a.apply(e,f)}},calders_forms_check_conditions=function(d){function e(a){if(b[a])return b[a]}if("undefined"!=typeof caldera_conditionals&&void 0!==caldera_conditionals[d]){var f=a(document.getElementById(d)),g=function(a){return"object"==typeof window.cfstate&&window.cfstate.hasOwnProperty(a)?window.cfstate[a]:null}(d);for(var h in caldera_conditionals[d]){if(jQuery("#conditional_"+h).length){var i=caldera_conditionals[d][h].type,j=caldera_conditionals[d][h].group,k=[];for(var l in j){var m={},n=j[l];for(var o in n){var p=f.find('[data-field="'+n[o].field+'"]'),q=[],r="function"==typeof n[o].value?n[o].value():n[o].value;if(void 0!==n[o].selectors)for(var s in n[o].selectors){var t=new RegExp(s,"g");r=r.replace(t,a(n[o].selectors[s]).val())}if(m[o]=!1,p.is(":radio,:checkbox"))p=p.filter(":checked");else if(p.is("div"))p=jQuery("<input>").val(p.html());else if(!p.length){var u=f.find('[data-calc-field="'+n[o].field+'"]');u.length&&(p=f.find('[data-calc-field="'+n[o].field+'"]'))}if(p.length)for(var v=0;v<p.length;v++)q.push(p[v].value);else q.push(n[o].field);switch(n[o].compare){case"is":q.length&&q.indexOf(r.toString())>=0&&(m[o]=!0);break;case"isnot":q.length&&q.indexOf(r)<0&&(m[o]=!0);break;case">":case"greater":m[o]=parseFloat(q.reduce(function(a,b){return a+b}))>parseFloat(r);break;case"<":case"smaller":m[o]=parseFloat(q.reduce(function(a,b){return a+b}))<parseFloat(r);break;case"startswith":for(var v=0;v<q.length;v++)q[v].toLowerCase().substr(0,r.toLowerCase().length)===r.toLowerCase()&&(m[o]=!0);break;case"endswith":for(var v=0;v<q.length;v++)q[v].toLowerCase().substr(q[v].toLowerCase().length-r.toLowerCase().length)===r.toLowerCase()&&(m[o]=!0);break;case"contains":for(var v=0;v<q.length;v++)q[v].toLowerCase().indexOf(r)>=0&&(m[o]=!0)}}istrue=!0;for(var w in m)if(!1===m[w]){istrue=!1;break}k.push(istrue)}var x,y=jQuery("#conditional-"+h+"-tmpl").html(),z=jQuery("#conditional_"+h),A=jQuery('[data-field="'+h+'"]');if(k.length&&k.indexOf(!0)>=0?"show"===i?x="show":"hide"===i?x="hide":"disable"===i&&(x="disable"):x="show"===i?"hide":"disable"===i?"enable":"show","show"===x)z.html().length||(z.html(y).trigger("cf.add",{field:h}),jQuery(document).trigger("cf.add",{field:h}),function(b,d){var g,h=e(b);if(void 0!=h)if("object"==typeof h)for(var i in h)!0===h[i]&&(g=a(document.getElementById(i)),g.prop("checked",!0));else g=a("#"+b),g.val(h);null!==d&&(d.rebind(b),void 0===g&&(g=a("#"+b)),c.hasOwnProperty(b)&&(g.attr("data-unsync","1"),g.removeAttr("data-sync"),g.removeAttr("data-binds")),void 0!==g&&g.data("sync")&&new CalderaFormsFieldSync(g,g.data("binds"),f,a,d))}(h,g));else if("hide"===x)z.html().length&&(!function(d,e){var f=a(document.getElementById(d));if(f.length){var g=f.val();g&&(b[d]=g)}else{var h;f=a("."+d),b[d]={},f.each(function(c,e){h=a(e),h.prop("checked")?b[d][h.attr("id")]=!0:b[d][h.attr("id")]=!1})}f.data("unsync")&&(c[d]=!0),null!==e&&e.unbind(d)}(h,g),A.val("").empty().prop("checked",!1),z.empty().trigger("cf.remove",{field:h}),jQuery(document).trigger("cf.remove",{field:h}));else if("enable"===x||"disable"===x){var B=jQuery("#"+h);"enable"==x?z.html().length?B.prop("disabled",!1):(z.html(y).trigger("cf.add",{field:h}),jQuery(document).trigger("cf.add").trigger("cf.enable",{field:h}),B.prop("disabled",!1)):z.html().length?B.prop("disabled","disabled",{field:h}):(z.html(y).trigger("cf.remove"),jQuery(document).trigger("cf.remove",{field:h}).trigger("cf.disable",{field:h}),B.prop("disabled","disabled",{field:h}))}}}}},calders_forms_init_conditions=function(){jQuery(".caldera_forms_form").on("change keyup","[data-field]",cf_debounce(function(b){var c=a(this).closest(".caldera_forms_form").prop("id");calders_forms_check_conditions(c)},10))},"undefined"!=typeof caldera_conditionals&&(calders_forms_init_conditions(),jQuery(".caldera_forms_form").find("[data-field]").first().trigger("change"))}(jQuery);